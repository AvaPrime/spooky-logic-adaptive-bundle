{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Spooky Capability Bundle",
  "type": "object",
  "required": [
    "id",
    "name",
    "version",
    "author",
    "created_at",
    "artifacts",
    "sbom",
    "provenance",
    "signatures"
  ],
  "properties": {
    "id": {
      "type": "string"
    },
    "name": {
      "type": "string"
    },
    "version": {
      "type": "string"
    },
    "author": {
      "type": "string"
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "artifacts": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "type",
          "uri",
          "sha256"
        ],
        "properties": {
          "type": {
            "type": "string"
          },
          "uri": {
            "type": "string"
          },
          "sha256": {
            "type": "string"
          }
        }
      }
    },
    "sbom": {
      "type": "object"
    },
    "provenance": {
      "type": "object"
    },
    "signatures": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "public_key_id",
          "signature"
        ],
        "properties": {
          "public_key_id": {
            "type": "string"
          },
          "signature": {
            "type": "string"
          }
        }
      }
    }
  }
}