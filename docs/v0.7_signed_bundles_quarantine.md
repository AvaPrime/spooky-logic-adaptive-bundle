# Spooky Logic v0.7 — Signed Capability Bundles & Quarantine Canary Lane

**Goals**
- Ensure only signed, provenance-attested capability bundles are adopted.
- Introduce a **quarantine lane** with canary traffic and auto-promotion gates.
- Allow **policy-based auto-adoption** when all signals are green.

**Pieces**
- Bundle schema (`capabilities/bundle.schema.json`), SBOM & provenance examples.
- Verifier (`orchestrator/capabilities/verifier.py`): checks signatures, SBOM, provenance.
- Quarantine Manager + Canary Controller: canary-rate routing and success tracking.
- OPA policies: `spooky.auto_adopt.allow_auto_adopt` and `spooky.quarantine.allow_promote_from_quarantine`.
- API routes: `/capabilities/verify`, `/capabilities/quarantine`, `/capabilities/quarantine/ready`.

**Flow**
1. Upload bundle → `/capabilities/verify` with public keys → must pass sig/SBOM/provenance checks.
2. Put in **quarantine** with canary rate (e.g., 2%). Canary-rated requests route to capability and report outcomes.
3. When `ready_to_promote` and policy gate approve, auto-adopt (integrate into router/tooling).

**Notes**
- Use CycloneDX or SPDX for SBOM; in-toto or SLSA for provenance.
- Keep keys in KMS; rotate regularly.
